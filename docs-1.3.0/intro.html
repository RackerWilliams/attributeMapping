

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; Attribute Mapping Policy Reference v1.3.0.1-SNAPSHOT</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Attribute Mapping Policy Reference v1.3.0.1-SNAPSHOT" href="index.html"/>
        <link rel="next" title="Attribute Mapping Basics" href="map.html"/>
        <link rel="prev" title="Attribute Mapping Policy Reference" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Attribute Mapping Policy Reference
          

          
          </a>

          
            
            
              <div class="version">
                1.3.0.1-SNAPSHOT
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#technology-background">Technology Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-is-attribute-mapping">What is Attribute Mapping?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#attribute-name-alignment">Attribute Name Alignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#role-and-group-alignment">Role and Group Alignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation-of-access-policies">Implementation of Access Policies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mapping-policy-for-widget-com">Mapping Policy for Widget.com</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="map.html">Attribute Mapping Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Attribute Mapping Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="xpath.html">XPath Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="yaml.html">YAML Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/common-end.html">Document history and additional information</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Attribute Mapping Policy Reference</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h1>
<p>Attribute mapping policies allow you to integrate with Rackspace
identity federation without having to make significant configuration
changes to your identity provider. An attribute mapping policy
provides a declarative means of extracting and transforming
information produced by your identity system so that it may seamlessly
inter-operate with Rackspace.</p>
<p>This document describes the attribute mapping policy language in
detail. It is intended as a guide to assist in the writing of mapping
policies as well as a reference for the features of the policy
language.</p>
<div class="section" id="technology-background">
<h2>Technology Background<a class="headerlink" href="#technology-background" title="Permalink to this headline">#</a></h2>
<p>In order to write attribute mapping policies you should have
a basic understanding of the following technologies:</p>
<dl class="docutils">
<dt>SAML 2.0</dt>
<dd>The Security Assertion Markup Language is an OASIS Standard for
defining XML-encoded assertions about authentication,
authorization, and related attributes. A basic understanding of the
SAML protocol is required, although this document concentrates
solely on SAML Responses and SAML Assertions.</dd>
<dt>XPath 2.0</dt>
<dd>XPath is a W3C standard expression language for extracting
information from structured data. The language is designed to be
embedded in a host language and it is used in this way by the
mapping policy language. The datatypes and function libraries
defined by the XPath standard are used in other policy languages
such as XACML. In most cases, only basic understanding of XPath is
required, see <a class="reference internal" href="xpath.html"><span class="doc">XPath Basics</span></a> for a quick overview.</dd>
<dt>YAML 1.1</dt>
<dd>YAML is a simple data serialization language that is designed to be
human friendly.  YAML is very similar to JSON but allows for useful
features such as comments and the ability to easily input
multi-line data. Attribute mapping policies are written in YAML,
see <a class="reference internal" href="yaml.html"><span class="doc">YAML Basics</span></a> for a quick overview.</dd>
</dl>
</div>
<div class="section" id="what-is-attribute-mapping">
<h2>What is Attribute Mapping?<a class="headerlink" href="#what-is-attribute-mapping" title="Permalink to this headline">#</a></h2>
<p>Your identity provider contains information about every user in your
organization.  For example, it maintains that Jane Doe is a
development manager whose username is <code class="docutils literal"><span class="pre">janed</span></code>. Jane’s email address
is <a class="reference external" href="mailto:janed&#37;&#52;&#48;widgets&#46;com">janed<span>&#64;</span>widgets<span>&#46;</span>com</a>, and as a development manager she is a member of
the <code class="docutils literal"><span class="pre">engineering</span></code>, <code class="docutils literal"><span class="pre">managers</span></code>, and <code class="docutils literal"><span class="pre">linux_user</span></code>
groups. Additionally, Jane is managing the <code class="docutils literal"><span class="pre">widgets_ui</span></code> project.</p>
<p>When Jane logs into Rackspace your organization’s identity provider
submits to Rackspace a cryptographically signed SAML response that
contains (among other things) the <em>attributes</em> described
above. Rackspace (the service provider) needs these attributes in
order to grant Jane access to Rackspace services.</p>
<p>Attribute mapping allows the extraction and transformation of the
attributes in the SAML response so they can be processed by
Rackspace. There are three major reasons why attribute mapping is
required:</p>
<div class="section" id="attribute-name-alignment">
<h3>Attribute Name Alignment<a class="headerlink" href="#attribute-name-alignment" title="Permalink to this headline">#</a></h3>
<p>Rackspace expects that Jane’s email is supplied in an attribute named
<code class="docutils literal"><span class="pre">email</span></code>, but your organization’s identity provider by default
submits a user’s email in an attribute named <code class="docutils literal"><span class="pre">mail</span></code>. This is not an
atypical situation because several competing standards exist for
attribute names. In this case the attribute <code class="docutils literal"><span class="pre">mail</span></code> must be mapped to
the attribute <code class="docutils literal"><span class="pre">email</span></code>.</p>
<p>The mapping is simple and can be summarized as follows:</p>
<p><code class="docutils literal"><span class="pre">mail</span></code> → <code class="docutils literal"><span class="pre">email</span></code></p>
</div>
<div class="section" id="role-and-group-alignment">
<h3>Role and Group Alignment<a class="headerlink" href="#role-and-group-alignment" title="Permalink to this headline">#</a></h3>
<p>The groups <code class="docutils literal"><span class="pre">engineering</span></code>, <code class="docutils literal"><span class="pre">managers</span></code>, and <code class="docutils literal"><span class="pre">linux_user</span></code> are
entirely meaningless to Rackspace.  Rackspace organizes its roles
according to the services it provides. For example, the <code class="docutils literal"><span class="pre">nova:admin</span></code>
role grants administration access to our OpenStack compute service and
the <code class="docutils literal"><span class="pre">ticketing:observer</span></code> role grants view only access to Rackspace
tickets.</p>
<p>In this case, we want the <code class="docutils literal"><span class="pre">managers</span></code> group to map to the
<code class="docutils literal"><span class="pre">ticketing:admin</span></code> role because any manager should be able to create
and edit tickets. We also want to map managers to the
<code class="docutils literal"><span class="pre">billing:observer</span></code> role because all managers can see invoices.
Additionally, we want to map the <code class="docutils literal"><span class="pre">linux_user</span></code> group to
<code class="docutils literal"><span class="pre">nova:observer</span></code> because all linux users should be able to query the
Compute API.</p>
<p>The mapping described above can be summarized as follows:</p>
<p><code class="docutils literal"><span class="pre">managers</span></code>    → <code class="docutils literal"><span class="pre">ticketing:admin</span></code>,  <code class="docutils literal"><span class="pre">billing:observer</span></code></p>
<p><code class="docutils literal"><span class="pre">linux_user</span></code>  → <code class="docutils literal"><span class="pre">nova:observer</span></code></p>
</div>
<div class="section" id="implementation-of-access-policies">
<h3>Implementation of Access Policies<a class="headerlink" href="#implementation-of-access-policies" title="Permalink to this headline">#</a></h3>
<p>The mapping above is fairly simple.  All users in the <code class="docutils literal"><span class="pre">managers</span></code>
group will obtain the <code class="docutils literal"><span class="pre">ticketing:admin</span></code> and <code class="docutils literal"><span class="pre">billing:observer</span></code>
roles. Unfortunately, things are often more complicated than this. For
example, some managers are actually contractors, and contractors
should not be allowed to view invoices so these contractors should not
receive the <code class="docutils literal"><span class="pre">billing:observer</span></code> role. You can tell that a user is a
contractor by looking at membership in the <code class="docutils literal"><span class="pre">contractors</span></code> group.</p>
<p>Additionally, there are separate Rackspace accounts for each project
managed by a manager. A manager involved with the <code class="docutils literal"><span class="pre">widgets_ui</span></code>
project should have full administrator rights (via the <code class="docutils literal"><span class="pre">admin</span></code> role)
to account <code class="docutils literal"><span class="pre">777654</span></code> – which is the account associated with that
project.  The identity provider passes an attribute named
<code class="docutils literal"><span class="pre">manager_projects</span></code> that contains the list of all of the projects
managed by a user.</p>
<p>There are two other projects to consider: <code class="docutils literal"><span class="pre">widgets_moble</span></code> is
associated with account <code class="docutils literal"><span class="pre">887655</span></code>, and <code class="docutils literal"><span class="pre">widgets_platform</span></code> which
should have admin access to account <code class="docutils literal"><span class="pre">779966</span></code>.</p>
<p>Note that by performing this mapping, you are implementing an access
policy that is executed whenever a user logs in. As long as relevant
information is provided by the identity provider in a SAML response
you can implement similar policies for your organization.</p>
<p>The mapping rules above can be summarized as follows:</p>
<p><code class="docutils literal"><span class="pre">managers</span></code> → <code class="docutils literal"><span class="pre">ticketing:admin</span></code>,  <code class="docutils literal"><span class="pre">billing:observer</span></code> unless the
user is also a member of <code class="docutils literal"><span class="pre">contractors</span></code>.</p>
<p><code class="docutils literal"><span class="pre">manager_projects</span></code> contains <code class="docutils literal"><span class="pre">widgets_ui</span></code>    → <code class="docutils literal"><span class="pre">admin</span></code> on
<code class="docutils literal"><span class="pre">777654</span></code></p>
<p><code class="docutils literal"><span class="pre">manager_projects</span></code> contains <code class="docutils literal"><span class="pre">widgets_moble</span></code> → <code class="docutils literal"><span class="pre">admin</span></code> on
<code class="docutils literal"><span class="pre">887655</span></code></p>
<p><code class="docutils literal"><span class="pre">manager_projects</span></code> contains <code class="docutils literal"><span class="pre">widgets_platform</span></code> → <code class="docutils literal"><span class="pre">admin</span></code> on
<code class="docutils literal"><span class="pre">779956</span></code></p>
</div>
</div>
<div class="section" id="mapping-policy-for-widget-com">
<h2>Mapping Policy for Widget.com<a class="headerlink" href="#mapping-policy-for-widget-com" title="Permalink to this headline">#</a></h2>
<p>The following attribute mapping policy implements the rules described
in the previous section. The rest of this document provides a guide
for writing such polices.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Mapping policy for Widget.com</span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">mapping</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">version</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">RAX-1</span>
  <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|-</span>
    <span class="no">The following is an attribute mapping for Widgets.com.   </span>
  <span class="l l-Scalar l-Scalar-Plain">rules</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">local</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">domain</span><span class="p p-Indicator">:</span> <span class="s">&quot;{D}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;{D}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">email</span><span class="p p-Indicator">:</span> <span class="s">&quot;{At(mail)}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">roles</span><span class="p p-Indicator">:</span> <span class="s">&quot;{0}&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">expire</span><span class="p p-Indicator">:</span> <span class="s">&quot;{D}&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">remote</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">multiValue</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
        <span class="l l-Scalar l-Scalar-Plain">path</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">|-</span>
             <span class="no">(:</span>
                <span class="no">The following describes the rules for assigning roles to</span>
                <span class="no">users.</span>
             <span class="no">:)</span>
              <span class="no">for $group in mapping:get-attributes(&#39;groups&#39;) return</span>
                  <span class="no">(:</span>
                    <span class="no">If a user is a manager they get ticketing:admin,</span>
                    <span class="no">If they are not a contractor then they also get billing:observer</span>
                    <span class="no">Managers become admin based on the project that they are working</span>
                    <span class="no">on</span>
                  <span class="no">:)</span>
                <span class="no">if ($group = &#39;managers&#39;) then</span>
                     <span class="no">(</span>
                      <span class="no">&#39;ticketing:admin&#39;,</span>
                      <span class="no">if (not(mapping:get-attributes(&#39;groups&#39;)=&#39;contractors&#39;)) then &#39;billing:observer&#39; else</span>
                      <span class="no">(),</span>
                      <span class="no">for $project in mapping:get-attributes(&#39;manager_projects&#39;) return</span>
                      <span class="no">(</span>
                         <span class="no">if ($project = &#39;widgets_ui&#39;)       then &#39;admin/777654&#39; else</span>
                         <span class="no">if ($project = &#39;widgets_mobile&#39;)   then &#39;admin/887655&#39; else</span>
                         <span class="no">if ($project = &#39;widgets_platform&#39;) then &#39;admin/779956&#39; else</span>
                         <span class="no">()</span>
                      <span class="no">)</span>
                     <span class="no">) else</span>
                <span class="no">(:</span>
                   <span class="no">If a user is a member of the linux_user group they get the</span>
                   <span class="no">nova:observer role.</span>
                <span class="no">:)</span>
                <span class="no">if ($group = &#39;linux_user&#39;) then &#39;nova:observer&#39; else</span>
                <span class="no">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="map.html" class="btn btn-neutral float-right" title="Attribute Mapping Basics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Attribute Mapping Policy Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Rackspace.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.3.0.1-SNAPSHOT',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>